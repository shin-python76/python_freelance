import pandas as pd

# CSVファイルの読み込み
df = pd.read_csv("sales_data.csv")

# 日付をdatetime型に変換
df["日付"] = pd.to_datetime(df["日付"])

# 月を抽出
df["月"] = df["日付"].dt.month

# 月ごとに売上金額を集計
monthly_sales = df.groupby("月")["売上金額"].sum().reset_index()

# ① df.groupby("月")
# 👉 「月」列をグループ化します。
# たとえば元データがこうだったとします：

# 日付	       商品名	   売上金額	    月
# 2025-01-03	ノート	   300	      1
# 2025-01-10	ペン	     150	      1
# 2025-02-05	ノート	   500	      2
# 2025-02-18	消しゴム	  200	       2
# 2025-03-07	ペン	     300	      3
# 2025-03-20	ノート	   600	       3

# これを「月」列でグループ化すると：
# グループ① → 月 = 1 のデータ
# グループ② → 月 = 2 のデータ
# グループ③ → 月 = 3 のデータ
# つまり、月ごとの小さなデータのかたまりを作っています。

# ② ["売上金額"]
# 👉 各グループの中から「売上金額」列だけを対象にします。
# なので「月ごとの売上金額の合計」を求める準備段階になります。

# .reset_index()
# 👉 「インデックスになっている ‘月’ を普通の列に戻す」処理です。
# これをしないと、「月」がインデックス（左端の番号）扱いのままになります。
# 見やすく表にするために .reset_index() を使います。

# 結果を出力
print("=== 月別売上集計 ===")
print(monthly_sales)
